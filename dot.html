<div class="safety-dashboard">
    <div class="safety-header">
        <div class="header-content">
            <h1 id="ticker-title">Since Last DOT Accident</h1>
            <div class="status-badge">‚óè Active</div>
        </div>
    </div>
    <div class="safety-body">
        <div class="timer-grid">
            <div class="time-card">
                <div id="days" class="number">0</div>
                <div class="label">DAYS</div>
            </div>
            <div class="time-card">
                <div id="hours" class="number">00</div>
                <div class="label">HOURS</div>
            </div>
            <div class="time-card">
                <div id="minutes" class="number">00</div>
                <div class="label">MINS</div>
            </div>
            <div class="time-card">
                <div id="seconds" class="number">00</div>
                <div class="label">SECS</div>
            </div>
        </div>
    </div>
</div>

<style>
:root {
    --bg-dark: #0f172a;
    --card-bg: #1e293b;
    --caution-yellow: #ffcc00;
    --dmt-blue: #002D62;
}

body {
    background-color: #020617;
    display: flex;
    justify-content: center;
    padding: 20px;
    font-family: 'Inter', sans-serif;
}

.safety-dashboard {
    width: 1068px;
    background: var(--bg-dark);
    border-radius: 20px;
    border: 1px solid #334155;
    overflow: hidden;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
}

.safety-header {
    background: var(--caution-yellow);
    padding: 20px 40px;
    border-bottom: 6px solid var(--dmt-blue);
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#ticker-title {
    color: #000;
    font-size: 24px;
    font-weight: 900;
    letter-spacing: 2px;
    margin: 0;
}

.status-badge {
    background: rgba(0, 0, 0, 0.1);
    color: #000;
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 800;
    letter-spacing: 1px;
}

.safety-body { padding: 40px; }

.timer-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
}

.time-card {
    background: var(--card-bg);
    padding: 30px 20px;
    border-radius: 16px;
    border: 1px solid #334155;
    text-align: center;
}

.number {
    font-size: 72px;
    font-weight: 900;
    color: white;
    line-height: 1;
    margin-bottom: 10px;
    font-variant-numeric: tabular-nums;
    text-shadow: 0 0 20px rgba(255, 204, 0, 0.2);
}

.label {
    color: #94a3b8;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 3px;
}
</style>

<script>
// Corrected CSV URL targeting the 'Last Acc' tab (gid=743293875)
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSXwF-92T09SgCmFnFLk6NjAWwK52BxFpyivdtrFtFWv-c4DdrF1jgpgZg7jWsyASCqVP7TxyDKVuH4/pub?gid=743293875&single=true&output=csv';

async function initDashboard() {
    try {
        const response = await fetch(CSV_URL + '&cache=' + new Date().getTime());
        const csvText = await response.text();
        const rows = csvText.split('\n').map(row => row.split(','));

        if (rows.length >= 3) {
            // Set Title from Cell A1
            document.getElementById('ticker-title').innerText = rows[0][0].replace(/"/g, '');
            
            // Combine Date (B2) and Time (B3)
            const datePart = rows[1][1].replace(/"/g, '').trim(); 
            const timePart = rows[2][1].replace(/"/g, '').trim(); 
            const accidentTime = new Date(`${datePart} ${timePart}`).getTime();
            
            if (!isNaN(accidentTime)) {
                runTicker(accidentTime);
            }
        }
    } catch (e) { 
        document.getElementById('ticker-title').innerText = "CONNECTION ERROR";
    }
}

function runTicker(accidentTimestamp) {
    const updateUI = () => {
        const now = new Date().getTime();
        const diff = Math.max(0, now - accidentTimestamp);

        const d = Math.floor(diff / 86400000);
        const h = Math.floor((diff % 86400000) / 3600000);
        const m = Math.floor((diff % 3600000) / 60000);
        const s = Math.floor((diff % 60000) / 1000);

        document.getElementById('days').innerText = d;
        document.getElementById('hours').innerText = h.toString().padStart(2, '0');
        document.getElementById('minutes').innerText = m.toString().padStart(2, '0');
        document.getElementById('seconds').innerText = s.toString().padStart(2, '0');
    };
    updateUI();
    setInterval(updateUI, 1000);
}

initDashboard();
</script>
