// This URL specifically targets the 'Last Acc' tab from your screenshot
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSXwF-92T09SgCmFnFLk6NjAWwK52BxFpyivdtrFtFWv-c4DdrF1jgpgZg7jWsyASCqVP7TxyDKVuH4/pub?gid=743293875&single=true&output=csv';

async function initDashboard() {
    try {
        const response = await fetch(CSV_URL + '&cache=' + new Date().getTime());
        const csvText = await response.text();
        const rows = csvText.split('\n').map(row => row.split(','));

        if (rows.length >= 2) {
            // 1. Title from Cell A1: "Last DOT Accident"
            document.getElementById('ticker-title').innerText = rows[0][0].replace(/"/g, '');
            
            // 2. Date from Cell B2 and Time from Cell B3
            const datePart = rows[1][1].replace(/"/g, '').trim(); // 02/9/2026
            const timePart = rows[2][1].replace(/"/g, '').trim(); // 11:20:00 AM
            
            const accidentDate = new Date(`${datePart} ${timePart}`).getTime();

            if (!isNaN(accidentDate)) {
                setInterval(() => {
                    const now = new Date().getTime();
                    const diff = Math.max(0, now - accidentDate);
                    
                    // Standard math to get total days
                    document.getElementById('days').innerText = Math.floor(diff / 86400000);
                }, 1000);
            } else {
                document.getElementById('ticker-title').innerText = "DATE ERROR: CHECK B2";
            }
        }
    } catch (e) {
        document.getElementById('ticker-title').innerText = "CONNECTION ERROR";
    }
}
initDashboard();
